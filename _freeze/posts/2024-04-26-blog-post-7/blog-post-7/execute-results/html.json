{
  "hash": "c7dbf5ae2d7980721303e7fb29f046f4",
  "result": {
    "markdown": "---\ntitle: \"blog post 7\"\nauthor: \"Group 13\"\ndate: \"2024-04-26\"\ndate-modified: \"2024-04-26\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\ndata <- read_csv(\"dataset/Cleaned_Pregnancy_Data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 912 Columns: 30\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): state, notes, versiondate, region\ndbl (26): year, pregnancyratelt15, pregnancyrate1517, pregnancyrate1819, pre...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\naverage_data <- data %>%\n  group_by(year, region) %>%\n  summarize(MeanAge = mean(average_age_of_pregnancy, na.rm = TRUE), .groups = 'drop')\n\nggplot(average_data, aes(x = year, y = MeanAge, color = region, group = region)) +\n  geom_line() +\n  labs(title = \"Trend of Mean Age of Pregnancy Over Time by Region\",\n       x = \"year\",\n       y = \"Mean Age of Pregnancy\") +\n  theme_minimal() +\n  scale_color_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(readr)\n\ndata <- read_csv(\"dataset/phc_mmr_with_age.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1176 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): state, AverageAge, Region\ndbl (3): year, spending, mean_val\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndata$spending <- as.numeric(data$spending)\ndata$AverageAge <- as.numeric(data$AverageAge)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nggplot(data, aes(x = spending, y = AverageAge, color = Region)) +\n  geom_point(aes(size = 3), alpha = 0.6) +  \n  geom_smooth(method = \"lm\", se = FALSE, aes(group = Region)) +  \n  scale_size_identity() +  \n  labs(title = \"Bubble Chart with Fitted Lines by Region\",\n       x = \"Healthcare Spending\",\n       y = \"Average Age of Pregnancy\",\n       size = \"Region\") +\n  theme_minimal() +\n  facet_wrap(~Region)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 462 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 462 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  guides(color = guide_legend(title = \"Region\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$colour\n$title\n[1] \"Region\"\n\n$title.position\nNULL\n\n$title.theme\nNULL\n\n$title.hjust\nNULL\n\n$title.vjust\nNULL\n\n$label\n[1] TRUE\n\n$label.position\nNULL\n\n$label.theme\nNULL\n\n$label.hjust\nNULL\n\n$label.vjust\nNULL\n\n$keywidth\nNULL\n\n$keyheight\nNULL\n\n$direction\nNULL\n\n$override.aes\nnamed list()\n\n$nrow\nNULL\n\n$ncol\nNULL\n\n$byrow\n[1] FALSE\n\n$reverse\n[1] FALSE\n\n$order\n[1] 0\n\n$available_aes\n[1] \"any\"\n\n$name\n[1] \"legend\"\n\nattr(,\"class\")\n[1] \"guide\"  \"legend\"\n\nattr(,\"class\")\n[1] \"guides\"\n```\n:::\n\n```{.r .cell-code}\n# Print the plot\nprint(ggplot(data, aes(x = spending, y = AverageAge, color = Region)) +\n  geom_point(aes(size = 3), alpha = 0.6) +  \n  geom_smooth(method = \"lm\", se = FALSE, aes(group = Region)) +  \n  scale_size_identity() +  \n  labs(title = \"Healthcare Spending vs. Average Age of Pregnancy by Region\",\n       x = \"Healthcare Spending\",\n       y = \"Average Age of Pregnancy\") +\n  theme_minimal() +\n  facet_wrap(~Region)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 462 rows containing non-finite values (`stat_smooth()`).\nRemoved 462 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = AverageAge, y = mean_val, size = spending)) +\n  geom_point(alpha = 0.6) +\n  facet_wrap(~Region) +\n  labs(title = \"Bubble Chart of Average Age, MMR, and Healthcare Spending\",\n       x = \"Average Age of Pregnancy\",\n       y = \"MMR (per 100,000 live births)\",\n       size = \"Healthcare Spending\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 462 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "blog-post-7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}